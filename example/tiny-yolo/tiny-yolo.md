# tiny-yolo サンプル

## 準備
YAD2K: Yet Another Darknet 2 Kerasが動くようにする。

https://github.com/allanzelener/YAD2K

tiny-yolo-voｃ版のcfgファイルと、対応する重みデータをダウンロードして、YAD2Kを使って重みデータを作成し、tyolo.h5の名前で保存する。
tyolo.h5を、weightディレクトリの下へコピーする。

## 使い方
keras ディレクトリへ移動し、tiny-yolo.pyを実行する。
```
cd keras
python tiny-yolo.py
```

## Cソースの作成
tiny-yoloディレクトリに戻り、コキュートスを起動する。
```
cd ..
python ../../cocytus.py tiny-yolo.ini
```

## Keras
### ネットワーク情報
```
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_1 (Conv2D)            (None, 416, 416, 16)      432
_________________________________________________________________
batch_normalization_1 (Batch (None, 416, 416, 16)      64
_________________________________________________________________
leaky_re_lu_1 (LeakyReLU)    (None, 416, 416, 16)      0
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 208, 208, 16)      0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 208, 208, 32)      4608
_________________________________________________________________
batch_normalization_2 (Batch (None, 208, 208, 32)      128
_________________________________________________________________
leaky_re_lu_2 (LeakyReLU)    (None, 208, 208, 32)      0
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 104, 104, 32)      0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 104, 104, 64)      18432
_________________________________________________________________
batch_normalization_3 (Batch (None, 104, 104, 64)      256
_________________________________________________________________
leaky_re_lu_3 (LeakyReLU)    (None, 104, 104, 64)      0
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 52, 52, 64)        0
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 52, 52, 128)       73728
_________________________________________________________________
batch_normalization_4 (Batch (None, 52, 52, 128)       512
_________________________________________________________________
leaky_re_lu_4 (LeakyReLU)    (None, 52, 52, 128)       0
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 26, 26, 128)       0
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 26, 26, 256)       294912
_________________________________________________________________
batch_normalization_5 (Batch (None, 26, 26, 256)       1024
_________________________________________________________________
leaky_re_lu_5 (LeakyReLU)    (None, 26, 26, 256)       0
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 13, 13, 256)       0
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 13, 13, 512)       1179648
_________________________________________________________________
batch_normalization_6 (Batch (None, 13, 13, 512)       2048
_________________________________________________________________
leaky_re_lu_6 (LeakyReLU)    (None, 13, 13, 512)       0
_________________________________________________________________
max_pooling2d_6 (MaxPooling2 (None, 13, 13, 512)       0
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 13, 13, 1024)      4718592
_________________________________________________________________
batch_normalization_7 (Batch (None, 13, 13, 1024)      4096
_________________________________________________________________
leaky_re_lu_7 (LeakyReLU)    (None, 13, 13, 1024)      0
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 13, 13, 1024)      0
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 13, 13, 1024)      9437184
_________________________________________________________________
batch_normalization_8 (Batch (None, 13, 13, 1024)      4096
_________________________________________________________________
leaky_re_lu_8 (LeakyReLU)    (None, 13, 13, 1024)      0
_________________________________________________________________
max_pooling2d_8 (MaxPooling2 (None, 13, 13, 1024)      0
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 13, 13, 125)       128125
=================================================================
Total params: 15,867,885.0
Trainable params: 15,861,773.0
Non-trainable params: 6,112.0
_________________________________________________________________

```

## 謝辞
重みの変換だけでなく、NN処理後の後処理についても参考にさせていただきました。ありがとうございます。

https://github.com/allanzelener/YAD2K